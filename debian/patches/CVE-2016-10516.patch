From 1034edc7f901dd645ec6e462754111b39002bd65 Mon Sep 17 00:00:00 2001
From: Your Name <neargle@outlook.com>
Date: Wed, 31 Aug 2016 16:00:55 +0800
Subject: [PATCH] fix XSS in debugger

Fix #1001
---
 CHANGES                   | 1 +
 werkzeug/debug/tbtools.py | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

#diff --git a/CHANGES b/CHANGES
#index 920db7584..547103a1f 100644
#--- a/CHANGES
#+++ b/CHANGES
#@@ -13,6 +13,7 @@ Bugfix release, unreleased.
#   see issue ``#995``.
# - Fix a bug in multidicts when passing empty lists as values, see issue
#   ``#979``.
#+- Fix a security issue that allows XSS on the Werkzeug debugger. See ``#1001``.
# 
# Version 0.11.10
# ---------------
Index: python-werkzeug-0.10.4+dfsg1/werkzeug/debug/tbtools.py
===================================================================
--- python-werkzeug-0.10.4+dfsg1.orig/werkzeug/debug/tbtools.py
+++ python-werkzeug-0.10.4+dfsg1/werkzeug/debug/tbtools.py
@@ -338,7 +338,7 @@ class Traceback(object):
             'exception':        exc,
             'exception_type':   escape(self.exception_type),
             'summary':          self.render_summary(include_title=False),
-            'plaintext':        self.plaintext,
+            'plaintext':        escape(self.plaintext),
             'plaintext_cs':     re.sub('-{2,}', '-', self.plaintext),
             'traceback_id':     self.id,
             'secret':           secret
